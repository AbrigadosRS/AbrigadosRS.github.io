
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Abrigados RS</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #ffffff;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 20px;
    }

    h1 {
      text-align: center;
      font-size: 3rem;
      font-weight: bold;
    }

    h2 {
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      margin-top: 2rem;
    }
    #botao-pesquisar {
        padding: 10px 20px;
        border: none;
        cursor: pointer;
        background-color: #e3f5d3;
        color: #333;
        border-radius: 20px;
        transition: background-color 0.3s, color 0.3s;
    }

    #botao-pesquisar:hover {
        background-color: #8dc63f;
        color: white;
    }


    #pesquisa {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column; /* Ajuste para colocar a caixa de texto e o botão em coluna */
      margin: 2rem;
    }

    #campo-pesquisa {
      padding: 1rem;
      border: 1px solid #ccc;
      font-size: 1rem;
      width: calc(70% - 10px); /* Ajuste para compensar a largura do botão de pesquisa */
      border-radius: 5px 5px 5px 5px;
    }

    #resultados {
      margin-top: 2rem;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    table th,
    table td {
      border: 1px solid #ccc;
      padding: 8px;
      cursor: pointer; /* Cursor de apontar para indicar que a coluna é clicável */
    }

    table th {
      background-color: #f2f2f2;
    }

    .loading-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px; /* Altura suficiente para centralizar verticalmente */
    }

    .loading {
      text-align: center;
    }

    .footer {
      text-align: center;
      font-size: 0.8rem; /* Tamanho menor de fonte */
      margin: 20px; /* Espaçamento superior */
    }

    .menu {
      text-align: center;
      margin-top: 20px;
    }

    .menu a {
      text-decoration: none;
      color: #333;
      font-weight: bold;
      font-size: 1.2rem;
      display: inline-block;
      margin-right: 20px;
      padding: 10px 20px;
      border-radius: 20px;
      background-color: #e3f5d3;
      transition: background-color 0.3s, color 0.3s;
    }

    .menu a:hover {
      background-color: #8dc63f;
      color: white;
    }

    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
    }

    .delete-icon {
      fill: #8dc63f; /* Defina a cor diretamente na classe do ícone */
    }
  </style>
</head>
<body>
<div class="menu">
  <a href="index.html" class="menu">Pesquisa de Abrigados</a>
  <a href="abrigos.html" class="menu">Lista de Abrigos</a>
</div>
  <div class="container">
    <h1>Abrigados RS</h1>
    <h2>Procura de pessoas abrigadas</h2>
    
    <div id="pesquisa">
      <input type="text" id="campo-pesquisa" placeholder="Nome da pessoa">
      <button id="botao-pesquisar">Pesquisar</button>
    </div>

    <div id="resultados"></div>
  </div>

  <div class="footer">
    Os dados foram todos coletados em planilhas abertas ao público.<br>Caso queiram/necessitem que seu nome seja removido da tabela, entre em contato através do e-mail logo abaixo<br>
    Caso você seja representante de um abrigo e queira nos ajudar, entre em contato no mesmo e-mail, ou envie sua tabela de abrigados diretamente.<br>
    cuidandodetodososgauchos@gmail.com
  </div>

  <script>
  $(document).ready(function() {
    // Handle search on Enter key press
    $("#campo-pesquisa").keypress(function(event) {
      if (event.which === 13) {
        event.preventDefault(); // Prevent default form submission
        $("#botao-pesquisar").click(); // Trigger search button click
      }
    });

    $("#botao-pesquisar").click(function() {
      var nomePesquisado = $("#campo-pesquisa").val().toLowerCase();

      // Show loading indicator
      $("#resultados").html("<div class='loading-container'><div class='loading'><img src='data/loading.gif' alt='Carregando...' /></div></div>");

      // Make AJAX request to PHP script
      $.ajax({
        url: "get_abrigados.php",
        type: "POST",
        data: { nome: nomePesquisado },
        dataType: "json",
        success: function(data) {
          // Hide loading indicator
          $("#resultados").html("");

          // Display results in a table
          var resultadosHTML = "<table>";
          resultadosHTML += "<tr><th onclick='sortTable(0)'>Nome</th><th onclick='sortTable(1)'>Bairro</th><th onclick='sortTable(2)'>Abrigo</th><th onclick='sortTable(3)'>Cidade</th><th>Ação</th></tr>"; // Adiciona a nova coluna no cabeçalho da tabela
          data.forEach(function(abrigado) {
            resultadosHTML += "<tr>";
            resultadosHTML += "<td>" + abrigado.nome + "</td>"; // Nome da pessoa
            resultadosHTML += "<td>" + abrigado.bairro + "</td>"; // Bairro
            resultadosHTML += "<td>" + abrigado.abrigo + "</td>"; // Abrigo
            resultadosHTML += "<td>" + abrigado.cidade + "</td>"; // Cidade
            resultadosHTML += "<td><img src='data/trash.svg' class='delete-icon' data-nome='" + abrigado.nome + "' alt='Remover'></td>"; // Adiciona a imagem da lata de lixo na nova coluna
            resultadosHTML += "</tr>";
          });
          resultadosHTML += "</table>";

          $("#resultados").html(resultadosHTML);

          // Adiciona evento de clique para a lata de lixo
          $(".delete-icon").click(function() {
            var nomeRemover = $(this).data("nome");
            // Remove o nome da tabela
            $.ajax({
              url: "remove_nome.php", // Substitua pelo nome do seu script PHP para remover o nome
              type: "POST",
              data: { nome: nomeRemover },
              success: function(response) {
                // Atualiza a tabela após a remoção bem-sucedida
                $("#botao-pesquisar").click();
              },
              error: function(xhr, status, error) {
                console.error("Erro ao remover nome: " + error);
                // Aqui você pode exibir uma mensagem de erro ao usuário
              }
            });
          });
        },
        error: function(xhr, status, error) {
          console.error("Erro ao buscar dados: " + error);
          $("#resultados").html("<div class='error'>Erro ao buscar dados. Por favor, tente novamente mais tarde.</div>");
        }
      });
    });
  });
    </script>
</body>
</html>
